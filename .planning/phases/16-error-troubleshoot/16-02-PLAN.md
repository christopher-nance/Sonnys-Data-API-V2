---
phase: 16-error-troubleshoot
plan: 02
type: execute
---

<objective>
Add logging configuration and troubleshooting sections to the error handling guide, wire it into the docs site navigation, and deploy to GitHub Pages.

Purpose: Complete the error handling guide with debugging tools (logging) and a troubleshooting FAQ, then make it live on the docs site.
Output: Updated guide with logging + troubleshooting, updated mkdocs.yml, deployed docs.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Files from Plan 01:
@docs/guides/error-handling.md
@.planning/phases/16-error-troubleshoot/16-01-SUMMARY.md

# Source files (logging and retry implementation):
@src/sonnys_data_client/_client.py

# Docs config:
@mkdocs.yml

**Established patterns:**
- Prior phases (14-02, 15-01) deploy with `mkdocs gh-deploy --force`
- Guide nav entries go under "Guides:" section in mkdocs.yml
- Admonitions for callouts, pipe tables for reference data
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add logging configuration and troubleshooting sections</name>
  <files>docs/guides/error-handling.md</files>
  <action>
Append two new sections to `docs/guides/error-handling.md` BEFORE the Quick Reference table (which should remain last):

**Section: Logging & Debugging**

1. "Enabling Debug Logging" — show how to configure Python logging to see SDK debug output:
   - `logging.basicConfig(level=logging.DEBUG)` for everything
   - `logging.getLogger("sonnys_data_client").setLevel(logging.DEBUG)` for SDK-only
   - Recommend adding a StreamHandler for scripts

2. "What Gets Logged" — table of log messages with level and meaning:
   - DEBUG: `Rate limiter: waiting {N}s` — pre-request rate limit sleep
   - DEBUG: `Request: {METHOD} {PATH} params={PARAMS}` — outgoing request
   - DEBUG: `Response: {METHOD} {PATH} status={CODE} elapsed={TIME}s` — successful response
   - WARNING: `Rate limited (429), retry {N}/{MAX} after {DELAY}s` — 429 backoff

3. "Reading Debug Output" — annotated example of a typical debug session showing a request that hits the rate limiter, succeeds, then a second request that gets a 429 and retries. Show the actual log lines and annotate what each means.

4. `!!! tip`: "In production, leave the SDK logger at WARNING to only see 429 retries. Set to DEBUG only when troubleshooting."

**Section: Common Issues & Troubleshooting**

Create a troubleshooting table/FAQ with these entries:

| Symptom | Likely Cause | Solution |
|---------|--------------|----------|
| `AuthError: MissingClientCredentialsError` | api_id or api_key not provided or empty | Check SonnysClient constructor args |
| `AuthError: BadClientCredentialsError` | Wrong api_id or api_key | Verify credentials with Sonny's support |
| `AuthError: NotAuthorizedSiteCredentialsError` | site_code not authorized for this API ID | Use a site_code linked to your API credentials |
| `RateLimitError` after retries exhausted | Too many concurrent requests | Reduce parallelism or increase max_retries |
| `ValidationError: PayloadValidationError` | Bad date format or invalid parameter | Use YYYY-MM-DD format, check parameter names |
| `NotFoundError: EntityNotFoundError` | Resource ID doesn't exist or wrong site | Verify ID and site_code match |
| `ServerError` intermittent 500s | Sonny's API transient issue | Add retry logic for 5xx (see Custom Retry Patterns) |
| `APIConnectionError` | Network/DNS failure | Check internet, verify trigonapi.sonnyscontrols.com is reachable |
| `APITimeoutError` | Request took too long | Use smaller date ranges, check network latency |
| Slow responses but no errors | Rate limiter pre-emptively sleeping | Enable DEBUG logging to see rate limiter waits |
| `ImportError` on exceptions | Wrong import path | Import from `sonnys_data_client` directly, not `_exceptions` |

Add a "Diagnostic Checklist" with numbered steps for when things go wrong:
1. Enable DEBUG logging
2. Check the error_type attribute for the specific API error
3. Inspect the body attribute for the full API response
4. Verify credentials with a simple `client.sites.list()` call
5. Check rate limiter state with debug logs

Use `!!! warning` for the most common gotcha (date format must be YYYY-MM-DD, not MM/DD/YYYY).
  </action>
  <verify>Grep for "Logging" and "Troubleshooting" section headers. Verify the troubleshooting table has at least 8 rows.</verify>
  <done>Guide has logging configuration, debug output interpretation, troubleshooting table with 10+ entries, and diagnostic checklist.</done>
</task>

<task type="auto">
  <name>Task 2: Update mkdocs.yml navigation and deploy to GitHub Pages</name>
  <files>mkdocs.yml</files>
  <action>
1. Add "Error Handling" entry to the Guides section in mkdocs.yml nav, placed AFTER "Transactions" (last resource guide) and before "API Reference":

```yaml
  - Guides:
      - Customers: guides/customers.md
      - Items: guides/items.md
      - Employees: guides/employees.md
      - Sites: guides/sites.md
      - Giftcards: guides/giftcards.md
      - Washbooks: guides/washbooks.md
      - Recurring Accounts: guides/recurring.md
      - Transactions: guides/transactions.md
      - Error Handling: guides/error-handling.md
```

2. Build docs to verify no errors: `python -m mkdocs build`
3. Deploy: `python -m mkdocs gh-deploy --force`
  </action>
  <verify>`python -m mkdocs build` succeeds. `git log --oneline -1 gh-pages` shows fresh deploy.</verify>
  <done>mkdocs.yml updated with Error Handling guide in nav, docs built without errors, deployed to GitHub Pages.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Logging section covers enable, what's logged, reading output
- [ ] Troubleshooting table has 10+ symptom/cause/solution rows
- [ ] Diagnostic checklist present
- [ ] mkdocs.yml nav includes "Error Handling" guide
- [ ] `python -m mkdocs build` succeeds without errors
- [ ] Deployed to gh-pages
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Error handling guide is complete with patterns + logging + troubleshooting
- Guide appears in docs site navigation
- Docs deployed to GitHub Pages
- Phase 16 complete
</success_criteria>

<output>
After completion, create `.planning/phases/16-error-troubleshoot/16-02-SUMMARY.md`
</output>
