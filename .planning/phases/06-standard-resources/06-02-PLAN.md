---
phase: 06-standard-resources
plan: 02
type: execute
---

<objective>
Implement Employees and Sites resource classes and wire them into SonnysClient, completing Phase 6.

Purpose: Provide `client.employees.list()`, `client.employees.get(id)`, `client.employees.get_clock_entries(id)`, and `client.sites.list()` — finishing all standard resources.
Output: Two resource modules, updated SonnysClient with all 4 resource properties, full Phase 6 verification.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-standard-resources/06-01-SUMMARY.md

# Key source files:
@src/sonnys_data_client/_resources.py
@src/sonnys_data_client/_client.py
@src/sonnys_data_client/__init__.py
@src/sonnys_data_client/resources/__init__.py
@src/sonnys_data_client/types/_employees.py
@src/sonnys_data_client/types/_sites.py

**Tech stack available:** hatchling, requests, pydantic, pytest, ruff
**Established patterns:** mixin-based resource classes, cached_property for client resource access, underscore-prefixed internals
**Constraining decisions:**
- Phase 05: ListableResource/GettableResource as independent mixins
- Phase 05: _paginated=False for non-paginated endpoints
- Phase 06-01: cached_property pattern for wiring resources into SonnysClient
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Employees and Sites resource classes</name>
  <files>src/sonnys_data_client/resources/_employees.py, src/sonnys_data_client/resources/_sites.py</files>
  <action>
**resources/_employees.py — Employees class:**
- Inherit from ListableResource AND GettableResource
- `_path = "/employee"`
- `_items_key = "employees"`
- `_model = EmployeeListItem` (from types._employees)
- `_default_limit = 100`
- `_paginated = True`
- `_detail_path = "/employee/{id}"`
- `_detail_model = Employee` (from types._employees)

Add a custom `get_clock_entries` method:
```python
def get_clock_entries(
    self,
    employee_id: int | str,
    *,
    start_date: str | None = None,
    end_date: str | None = None,
) -> list[ClockEntry]:
```
- Calls `self._client._request("GET", f"/employee/{employee_id}/clock-entries", params=params)`
- Build params dict from start_date/end_date (use camelCase keys: `startDate`, `endDate`) — only include non-None values
- Response JSON structure: `data.weeks[]` where each week has `clockEntries[]` array
- Flatten: iterate over `data["weeks"]`, iterate over each week's `"clockEntries"`, validate each with `ClockEntry.model_validate(entry)`
- Return flat `list[ClockEntry]`
- Import ClockEntry from types._employees

**resources/_sites.py — Sites class:**
- Inherit from ListableResource only (list, no detail endpoint)
- `_path = "/site/list"` — NOTE: API path is `/site/list` not `/site`
- `_items_key = "sites"`
- `_model = Site` (from types._sites)
- `_paginated = False` — API returns all sites in single response, no pagination
  </action>
  <verify>python -c "from sonnys_data_client.resources._employees import Employees; from sonnys_data_client.resources._sites import Sites; print('OK')"</verify>
  <done>Employees class has list(), get(), and get_clock_entries() methods. Sites class has list() with _paginated=False. Both importable without errors.</done>
</task>

<task type="auto">
  <name>Task 2: Wire Employees and Sites into SonnysClient and verify all resources</name>
  <files>src/sonnys_data_client/_client.py, src/sonnys_data_client/resources/__init__.py, src/sonnys_data_client/__init__.py</files>
  <action>
**resources/__init__.py:**
Add exports for Employees and Sites alongside existing Customers and Items.

**_client.py:**
Add `employees` and `sites` as `@functools.cached_property` on SonnysClient, same pattern as customers/items from Plan 01. Return `Employees(self)` and `Sites(self)`.

**__init__.py:**
Add Employees and Sites to imports and __all__.

Verify complete resource surface:
- client.customers → Customers (list + get)
- client.items → Items (list)
- client.employees → Employees (list + get + get_clock_entries)
- client.sites → Sites (list, non-paginated)
  </action>
  <verify>python -c "from sonnys_data_client import SonnysClient, Customers, Items, Employees, Sites; c = SonnysClient('x','y'); print(type(c.customers).__name__, type(c.items).__name__, type(c.employees).__name__, type(c.sites).__name__)"</verify>
  <done>All 4 resources accessible as client properties, all exported from package, no import errors, all prior tests pass, no lint errors</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python -c "from sonnys_data_client import SonnysClient, Customers, Items, Employees, Sites"` — no import errors
- [ ] `python -c "c = SonnysClient('x','y'); print(type(c.customers).__name__, type(c.items).__name__, type(c.employees).__name__, type(c.sites).__name__)"` — prints "Customers Items Employees Sites"
- [ ] `pytest tests/ -x -q` — all tests pass
- [ ] `ruff check src/sonnys_data_client/` — no lint errors
- [ ] Employees.get_clock_entries method exists with correct signature
</verification>

<success_criteria>

- All 4 standard resources implemented and wired into SonnysClient
- Employees has custom get_clock_entries that flattens weeks structure
- Sites uses _paginated=False and path="/site/list"
- All verification checks pass
- Phase 6 complete
</success_criteria>

<output>
After completion, create `.planning/phases/06-standard-resources/06-02-SUMMARY.md`
</output>
