---
phase: 01-project-foundation
plan: 01
type: execute
---

<objective>
Establish the Python package structure with pyproject.toml, src layout, and SonnysClient class shell.

Purpose: Create the foundational package that all subsequent phases build on — correct packaging from day one prevents import bugs, build failures, and rework.
Output: A pip-installable (editable) Python package with a SonnysClient class that initializes a requests.Session with auth headers.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-project-foundation/01-RESEARCH.md

**Tech decisions from research (HIGH confidence):**
- Build backend: hatchling (PyPA-maintained, PEP 621-native)
- Layout: src layout (prevents import masking bugs)
- Client pattern: OpenAI/Stainless `@cached_property` resource pattern
- Internal modules: underscore-prefixed (`_client.py`, `_version.py`)
- License format: PEP 639 SPDX string (`license = "MIT"`)
- Type hints: Python 3.10+ native syntax (`str | None`, not `Optional[str]`)
- Dependencies: `requests>=2.28,<3` + `pydantic>=2.10,<3`
- Dev deps: `pytest>=7.0` + `ruff>=0.1`

**Don't hand-roll (from research):**
- Package metadata → pyproject.toml (PEP 621)
- Build system → hatchling
- HTTP session → requests.Session
- Version pinning → compatible release (`>=X,<Y`)

**Pitfalls to avoid (from research):**
- Flat layout masking import bugs → use src layout
- Missing py.typed marker → include it from start
- Old license format `{text = "MIT"}` → use SPDX `"MIT"` (PEP 639)
- `typing.Optional` / `typing.Union` → use `str | None` native syntax
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package structure and pyproject.toml</name>
  <files>pyproject.toml, .gitignore, LICENSE, src/sonnys_data_client/__init__.py, src/sonnys_data_client/_version.py, src/sonnys_data_client/py.typed, src/sonnys_data_client/resources/__init__.py, src/sonnys_data_client/types/__init__.py, tests/__init__.py</files>
  <action>
Create the complete package scaffolding:

1. **pyproject.toml** — Use hatchling build backend with PEP 621 metadata:
   - `name = "sonnys-data-client"`, `version = "0.1.0"`
   - `requires-python = ">=3.10"`
   - `license = "MIT"` (PEP 639 SPDX format — NOT `{text = "MIT"}`)
   - `license-files = ["LICENSE"]`
   - `dependencies = ["requests>=2.28,<3", "pydantic>=2.10,<3"]`
   - `[project.optional-dependencies] dev = ["pytest>=7.0", "ruff>=0.1"]`
   - `[tool.hatch.build.targets.wheel] packages = ["src/sonnys_data_client"]`
   - Add `description`, `readme = "README.md"`, classifiers for Python 3.10/3.11/3.12/3.13

2. **.gitignore** — Standard Python gitignore: __pycache__, *.pyc, *.egg-info, dist/, build/, .eggs/, *.egg, .venv/, .env, .pytest_cache/, .ruff_cache/

3. **LICENSE** — MIT license, copyright 2026 WashU Carwash

4. **src/sonnys_data_client/__init__.py** — Public API surface:
   - Import and re-export `SonnysClient` from `._client` (will exist after Task 2)
   - Import and re-export `__version__` from `._version`
   - Set `__all__` explicitly

5. **src/sonnys_data_client/_version.py** — Single source of truth: `__version__ = "0.1.0"`

6. **src/sonnys_data_client/py.typed** — Empty marker file (PEP 561)

7. **src/sonnys_data_client/resources/__init__.py** — Empty, placeholder for Phase 5+

8. **src/sonnys_data_client/types/__init__.py** — Empty, placeholder for Phase 4

9. **tests/__init__.py** — Empty, establishes test package
  </action>
  <verify>
Directory structure matches: `find src/ -type f | sort` shows all expected files. `cat pyproject.toml` shows hatchling backend, PEP 639 license format, correct dependencies.
  </verify>
  <done>All 9 files created. pyproject.toml uses hatchling + PEP 639 license. src layout with sonnys_data_client package, resources/ and types/ subdirectories, py.typed marker, .gitignore, LICENSE, tests/ directory all present.</done>
</task>

<task type="auto">
  <name>Task 2: Create SonnysClient class shell</name>
  <files>src/sonnys_data_client/_client.py, src/sonnys_data_client/__init__.py</files>
  <action>
Create the SonnysClient class as the foundation for all subsequent phases:

1. **src/sonnys_data_client/_client.py**:
   - `BASE_URL = "https://trigonapi.sonnyscontrols.com/v1"` class constant
   - `__init__(self, api_id: str, api_key: str, site_code: str | None = None)` — store credentials, create `requests.Session()`, set auth headers:
     - `"X-Sonnys-API-ID": api_id`
     - `"X-Sonnys-API-Key": api_key`
     - `"X-Sonnys-Site-Code": site_code` (only if provided)
   - `close(self)` — calls `self._session.close()`
   - `__enter__(self)` — returns `self`
   - `__exit__(self, *args)` — calls `self.close()`
   - `__repr__(self)` — returns `f"SonnysClient(base_url='{self.BASE_URL}')"`
   - Do NOT add `_request()` method (that's Phase 2: HTTP Transport)
   - Do NOT add `@cached_property` resource stubs yet (that's Phase 5+: Resource Framework)
   - Use `from __future__ import annotations` for forward reference support

2. **Update src/sonnys_data_client/__init__.py** — Ensure `SonnysClient` import works:
   - `from sonnys_data_client._client import SonnysClient`
   - `from sonnys_data_client._version import __version__`
   - `__all__ = ["SonnysClient", "__version__"]`

**What to avoid:**
- Do NOT use `typing.Optional` — use `str | None` (Python 3.10+ native syntax)
- Do NOT create a module-level client singleton — per-instance only
- Do NOT add resource properties or HTTP methods — those belong to later phases
- Do NOT import from `typing` module at all (no `Optional`, `Union`, `List`, `Dict`)
  </action>
  <verify>
Run: `pip install -e ".[dev]"` then `python -c "from sonnys_data_client import SonnysClient, __version__; c = SonnysClient(api_id='test', api_key='test'); print(f'{c!r}, v{__version__}'); c.close()"` — should print client repr and version without errors. Then: `python -c "with __import__('sonnys_data_client').SonnysClient(api_id='a', api_key='b') as c: print('context manager works')"` — should print confirmation.
  </verify>
  <done>SonnysClient instantiates with credentials, creates requests.Session with auth headers, supports close() and context manager protocol, editable install works, import from package root works.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pip install -e ".[dev]"` succeeds without errors or warnings
- [ ] `python -c "import sonnys_data_client"` works (src layout validated)
- [ ] `python -c "from sonnys_data_client import SonnysClient, __version__"` works
- [ ] `SonnysClient(api_id='x', api_key='y')` creates instance with session
- [ ] `SonnysClient(api_id='x', api_key='y', site_code='z')` sets site code header
- [ ] Context manager protocol works (`with SonnysClient(...) as c:`)
- [ ] No `typing.Optional` or `typing.Union` in any file (use native `X | None`)
- [ ] `py.typed` marker file exists
- [ ] `pyproject.toml` uses `license = "MIT"` (PEP 639 SPDX, not `{text = "MIT"}`)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Package installs in editable mode from src layout
- SonnysClient class initializes session with correct auth headers
- No typing module imports (Python 3.10+ native syntax throughout)
- Foundation ready for Phase 2 (HTTP Transport) to add `_request()` method
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-foundation/01-01-SUMMARY.md`
</output>
