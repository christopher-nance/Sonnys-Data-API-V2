---
phase: 17-advanced-patterns
plan: 02
type: execute
---

<objective>
Add integration recipes to the Advanced Patterns guide and deploy the updated docs to GitHub Pages.

Purpose: Provide ready-to-use recipes for the most common SDK integration scenarios — CSV export, scheduled automation, and data pipeline patterns.
Output: Completed `docs/guides/advanced-patterns.md` with integration recipes, updated mkdocs.yml nav, deployed docs site.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/17-advanced-patterns/17-01-SUMMARY.md

# Key source files (for accurate code examples):
@src/sonnys_data_client/_client.py
@src/sonnys_data_client/resources/_transactions.py
@src/sonnys_data_client/resources/_recurring.py

# Current guide (extend it):
@docs/guides/advanced-patterns.md

# mkdocs config:
@mkdocs.yml

**Tech stack available:** mkdocs-material, mkdocstrings, pymdownx extensions, admonition
**Established patterns:** admonition-rich guides, code examples, nav update + gh-pages deploy as final task
**Constraining decisions:**
- [Phase 17-01]: Multi-site, rate limiting, and performance sections already written — this plan adds integration recipes
- [Phase 12]: GitHub Pages deploy pattern established (`mkdocs gh-deploy --force`)
- [Phase 16]: Nav updates go in Guides section of mkdocs.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Integration Recipes section to advanced-patterns.md</name>
  <files>docs/guides/advanced-patterns.md</files>
  <action>
Append to `docs/guides/advanced-patterns.md`:

**Integration Recipes** — Ready-to-use patterns for common integration scenarios:

1. **Export to CSV** — Complete recipe for exporting transaction data to CSV using Python's built-in `csv` module. Show: creating the client, fetching data for a date range, writing to CSV with headers derived from Pydantic model fields. Use `model_dump()` to serialize. Include a `!!! tip` about using `list_v2()` for enriched CSV exports vs `list()` for lightweight ones.

2. **Export to JSON** — Similar pattern using `json` module. Show `model_dump(mode="json")` for JSON-serializable output. Mention `model_dump(by_alias=True)` if the consumer expects camelCase field names (matching the raw API format).

3. **Scheduled Daily Export** — Recipe for a script that exports yesterday's transactions to a date-stamped file. Show: calculating yesterday's date, fetching data, writing to CSV, and basic logging. Include a `!!! note` about running this with cron (Linux/Mac) or Task Scheduler (Windows). Show the cron line: `0 6 * * * python /path/to/daily_export.py`.

4. **Multi-Site Daily Report** — Combine multi-site patterns from earlier in the guide with the CSV export recipe. Show: iterating sites, exporting per-site CSV files OR a single consolidated CSV with a site_code column. Reference the Multi-Site Operations section.

5. **Data Pipeline Pattern** — A more complete recipe showing: fetch → validate → transform → load. Example: pull recurring account data, filter to active accounts, calculate metrics (active count, MRR from billing amounts), write summary to JSON. Use a simple function-based pipeline structure (not over-engineered). Include error handling with try/except around the fetch step, referencing the error-handling guide.

6. **Monitoring & Alerting Recipe** — Simple pattern for checking KPIs and alerting. Example: count today's transactions, compare to a threshold, print warning if below expected volume. Show how this integrates with the logging configuration from error-handling.md. Include a `!!! tip` about extending this with email alerts or Slack webhooks (mention but don't implement — keep it simple).

All recipes should be complete, copy-pasteable scripts. Use realistic Sonny's car wash data. Each recipe should be 15-30 lines of Python, not over-engineered. The goal is "copy this, change the credentials, run it."

Do NOT add dependencies beyond the standard library + the SDK itself. Recipes use only: `csv`, `json`, `datetime`, `logging`, `pathlib` from stdlib.
  </action>
  <verify>Confirm advanced-patterns.md has Integration Recipes section with 6 subsections. Each recipe should have a complete, runnable code example.</verify>
  <done>Integration Recipes section added with 6 recipes, all with complete code examples using only stdlib + SDK.</done>
</task>

<task type="auto">
  <name>Task 2: Update mkdocs.yml navigation and deploy to GitHub Pages</name>
  <files>mkdocs.yml</files>
  <action>
1. Add "Advanced Patterns" entry to the Guides section in mkdocs.yml nav, after "Error Handling" (last current entry) so the guide progression flows: resource guides → error handling → advanced patterns.

2. Build and deploy docs to GitHub Pages using `mkdocs gh-deploy --force`. Verify the build succeeds without warnings.
  </action>
  <verify>Run `mkdocs build --strict` to verify no broken links or warnings. Then run `mkdocs gh-deploy --force` and confirm deployment succeeds.</verify>
  <done>mkdocs.yml updated with Advanced Patterns in nav. Docs built and deployed to GitHub Pages successfully.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Integration Recipes section has 6 complete recipes
- [ ] All code examples are runnable (only stdlib + SDK dependencies)
- [ ] mkdocs.yml nav includes Advanced Patterns after Error Handling
- [ ] `mkdocs build --strict` passes without errors
- [ ] Docs deployed to GitHub Pages
- [ ] Phase 17 complete
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Advanced Patterns guide is complete with 4 major sections
- Docs site is live with the new guide
- Phase 17 complete
</success_criteria>

<output>
After completion, create `.planning/phases/17-advanced-patterns/17-02-SUMMARY.md`

Include "Phase 17 complete" in success criteria since this is the final plan in the phase.
</output>
